{% extends "base.html" %}

{% load i18n rsr_filters humanize rsr_utils maps %}

{% block title %}{{organisation.name}}{% endblock %}

{% block maincontent %}

<div class="container">
    <div class="row">
        <div class="col-sm-5">
            <h1>{{organisation.name}}</h1>
            {% if organisation.url %}<a href="{{organisation.url}}">{{organisation.url}}</a>{% endif %}
            <br><br>
            {% if organisation.primary_location.address_1 %}{{organisation.primary_location.address_1}}<br>{% endif %}
            {% if organisation.primary_location.address_2 %}{{organisation.primary_location.address_2}}<br>{% endif %}
            {% if organisation.primary_location.postcode %}{{organisation.primary_location.postcode}}<br>{% endif %}
            {% if organisation.primary_location.city %}{{organisation.primary_location.city}}<br>{% endif %}
            {% if organisation.primary_location.state %}{{organisation.primary_location.state}}<br>{% endif %}
            {% if organisation.primary_location.country %}{{organisation.primary_location.country}}{% endif %}
            {% if organisation.contact_email or organisation.phone %}
            <h4>Contact information</h4>
            {% if organisation.contact_email %}
            <a href="mailto:{{organisation.contact_email}}">{{organisation.contact_email}}</a>
            {% endif %}
            {% if organisation.phone %}
            <p>{{organisation.phone}}<br /></p>
            {% endif %}
            {% endif %}
        </div>
        <div class="col-sm-7">
            {% img organisation 350 250 organisation.name %}
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6">
            {{organisation.description|linebreaks}}
        </div>
    </div>
    <div class="row">
        <div class="col-xs-6">
            <h2>{% trans 'Projects in RSR' %}</h2>
            <table>
              <tr>
                <td>{% trans 'Active' %}</td>
                <td>{{organisation.published_projects.status_active.count}}</td>
              </tr>
              <tr>
                <td>{% trans 'Need funding' %}</td>
                <td>{{organisation.published_projects.status_onhold.count}}</td>
              </tr>
              <tr>
                <td>{% trans 'Complete' %}</td>
                <td>{{organisation.published_projects.status_complete.count}}</td>
              </tr>
              <tr>
                <td>{% trans 'Cancelled' %}</td>
                <td>{{organisation.published_projects.status_cancelled.count}}</td>
              </tr>
              <tr>
                <td>{% trans 'Total projects' %}</td>
                <td>{{organisation.published_projects.count}}</td>
              </tr>
            </table>
        </div>

        <div class="col-xs-6">
            <h2>{% trans 'Funding' %}</h2>
            <table class="org_statistics_table">
              {% if organisation.euro_projects_count %}
                <tr>
                  <td colspan="2">
                    {{organisation.euro_projects_count}}
                    {% trans 'project' %}{{organisation.euro_projects_count|pluralize:"s"}} {% trans 'in Euros' %}
                  </td>
                </tr>
                <tr>
                  <td>{% trans 'Pledged' %}</td>
                  <td>
                    € {{organisation.euros_pledged|round|intcomma}}
                  </td>
                </tr>
                <tr>
                  <td>{% trans 'Still needed' %}</td>
                  <td>
                    € {{organisation.euro_funds_needed|round|intcomma}}
                  </td>
                </tr>
              {% endif %}
              {% if organisation.euro_projects_count and organisation.dollar_projects_count %}
                <tr>
                  <td colspan="2">
                    &nbsp;
                  </td>
                </tr>
              {% endif %}
              {% if organisation.dollar_projects_count %}
                <tr>
                  <td colspan="2">
                    {{organisation.dollar_projects_count}}
                    {% trans 'project' %}{{organisation.dollar_projects_count|pluralize:"s"}} {% trans 'in US Dollars' %}
                  </td>
                </tr>
                <tr>
                  <td>{% trans 'Pledged' %}</td>
                  <td>
                    $ {{organisation.dollars_pledged|round|intcomma}}
                  </td>
                </tr>
                <tr>
                  <td>{% trans 'Still needed' %}</td>
                  <td>
                    $ {{organisation.dollar_funds_needed|round|intcomma}}
                  </td>
                </tr>
              {% endif %}
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <p>
                {% organisation_map organisation.id '100%' '300px' %}
            </p>
        </div>
    </div>
</div>

{% endblock %}
