{% extends "base.html" %}
{% load i18n bootstrap3 %}

{% block maincontent %}
<div class="container">
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <h2 class="text-center verticalPadding">{% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h1>

      {% if wizard.steps.current == 'welcome' %}
      <p>{% blocktrans trimmed %}You are about to take your account security to the
        next level. Follow the steps in this wizard to enable two-factor
        authentication.{% endblocktrans %}</p>
      {% elif wizard.steps.current == 'generator' %}
      <p>{% blocktrans trimmed %}To start using a token generator, please use your
        smartphone to scan the QR code below. For example, use Google
        Authenticator.{% endblocktrans %}</p>
        <p><img src="{{ QR_URL }}" alt="QR Code" class="bg-white"/></p>
        <p>{% blocktrans trimmed %}Alternatively you can use the following secret to
        setup TOTP in your authenticator or password manager manually.{% endblocktrans %}</p>
        <p>{% translate "TOTP Secret:" %} <a href="{{ otpauth_url }}">{{ secret_key }}</a></p>
        <p>{% blocktrans %}Then, enter the token generated by the app.{% endblocktrans %}</p>
      {% endif %}

      <form action="" method="post">
        {% csrf_token %}
        {% bootstrap_form_errors form type='non_fields' %}
        {{ wizard.management_form }}
        {% for field in wizard.form %}
          {% bootstrap_field field %}
        {% endfor %}

        {# hidden submit button to enable [enter] key #}
        <input type="submit" value="" hidden />

        <a href="/my-rsr/my-details/" class="pull-right btn btn-link">{% trans "Cancel" %}</a>
        {% if wizard.steps.prev %}
        <button name="wizard_goto_step" type="submit"
          value="{{ wizard.steps.prev }}"
          class="btn btn-secondary">{% trans "Back" %}</button>
        {% else %}
        <button disabled name="" type="button" class="btn">{% trans "Back" %}</button>
        {% endif %}
        <button type="submit" class="btn btn-primary">{% trans "Next" %}</button>

      </form>
    </div>
  </div>
<div>
{% endblock %}
