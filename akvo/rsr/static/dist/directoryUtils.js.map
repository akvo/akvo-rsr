{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./scripts-src/directory-utils.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","options_cache","Filter","React","createClass","displayName","render","Typeahead","ReactBootstrapTypeahead","createElement","className","ref","this","props","selected","options","onChange","filterBy","labelKey","highlightOnlyResult","placeholder","display_name","disabled","renderMenuItemChildren","item","repeat","indent","label","maxResults","componentWillReceiveProps","nextProps","length","refs","typeahead","getInstance","clear","values","changeNodeMarkerIcon","domNode","animation","projectId","id","console","log","mapMarkers","forEach","marker","highlightId","setAnimation","Project","highlightMarker","getDOMNode","google","maps","Animation","BOUNCE","unHighlightMarker","project","countries","join","i18n","no_location_text","element_id","onMouseEnter","onMouseLeave","href","url","src","image","alt","title","organisation_url","organisation","Update","project_url","class","user_fullname","event_date","Organisation","organisation_type","project_count","ProjectDirectory","componentDidUpdate","prevProps","projects","hide_map","window","render_map","document","querySelector","getMapConfig","ReactDOM","findDOMNode","scrollTop","getLocations","map","latitude","longitude","text","icon","dynamic","locations","clickCallback","setCountry","project_count_text","undefined","elements_text","loading_text","filtered","listWidth","listMsg","list_message_text","style","position","width","height","background","margin","padding","zIndex","textAlign","marginTop","type","Pagination","page","limit","getPages","Math","ceil","onSelect","e","preventDefault","target","ReactBootstrap","boundaryLinks","activePage","parseInt","items","maxButtons","TextSearch","getInitialState","componentDidMount","fetchOptions","setState","typeaheadUrl","app","fetch","then","response","status","json","mungeOptions","results","getUrl","entry","option","String","location","onInputChange","onSubmit","state","role","x","text_placeholder","minLength","onClick","search_text","SearchBar","reset_button","_","isEmpty","pick","resetFilters","reset_filters_text","title_or_subtitle","filters","filter_name","selection","dropdown_field","indexOf","find","selection_clone","assign","App","urlState","getStateFromUrl","keyword","sector","keys","fetchData","onpopstate","popstate","isEqual","typeahead_url","onFilterChange","dropdown_filters","limitOptions","page_size_default","field_name","update","updateHistory","cacheAllOptions","self","getOptionsUrl","parseResponse","cacheOptions","processOptions","mountedNow","cached_options","updateState","processedOptions","params","format","encodeURIComponent","options_url","getProjectUrl","query","search","substring","replace","split","query_term","pair","decodeURIComponent","isFilter","dropdown","hidden_or_other","make_typeahead_item","long_name","spaces","match","trim","history","queries","pairs","q","val","encodeURI","pushState","DirectoryApp"],"mappings":"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","file":"directoryUtils.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1044);\n","// Akvo RSR is covered by the GNU Affero General Public License.\n// See more details in the license.txt file located at the root folder of the\n// Akvo RSR module. For additional details on the GNU license please see\n// < http://www.gnu.org/licenses/agpl.html >.\n\nvar options_cache = {};\n\nvar Filter = React.createClass({\n    render: function() {\n        var Typeahead = ReactBootstrapTypeahead.Typeahead;\n        var show_indented = function(item) {\n            return \"\\u00A0\".repeat(item.indent) + item.label;\n        };\n        return (\n            <div className=\"advanced-filter\">\n                <Typeahead\n                    ref=\"typeahead\"\n                    name={this.props.name}\n                    selected={this.props.selected}\n                    options={this.props.options}\n                    onChange={this.onChange}\n                    filterBy={[\"filterBy\"]}\n                    labelKey=\"label\"\n                    highlightOnlyResult={true}\n                    placeholder={this.props.display_name}\n                    disabled={this.props.disabled}\n                    renderMenuItemChildren={show_indented}\n                    maxResults={10000}\n                />\n                <span className=\"caret\" />\n            </div>\n        );\n    },\n    componentWillReceiveProps: function(nextProps) {\n        // Clear the typeaheads, when selections have been removed programmatically\n        if (this.props.selected.length > 0 && nextProps.selected.length == 0) {\n            this.refs.typeahead.getInstance().clear();\n        }\n    },\n    onChange: function(values) {\n        this.props.onChange(this.props.name, values);\n    }\n});\n\nvar changeNodeMarkerIcon = function(domNode, animation) {\n    var projectId = domNode.id;\n    console.log(projectId);\n    mapMarkers.forEach(function(marker) {\n        if (\"#\" + projectId == marker.highlightId) {\n            marker.setAnimation(animation);\n        }\n    });\n};\n\nvar Project = React.createClass({\n    highlightMarker: function() {\n        return changeNodeMarkerIcon(this.getDOMNode(), google.maps.Animation.BOUNCE);\n    },\n    unHighlightMarker: function() {\n        return changeNodeMarkerIcon(this.getDOMNode(), null);\n    },\n    render: function() {\n        var project = this.props.project,\n            countries =\n                \" \" +\n                (project.countries.length > 0\n                    ? project.countries.join(\", \")\n                    : this.props.i18n.no_location_text),\n            element_id = \"project-\" + project.id;\n        return (\n            <li\n                id={element_id}\n                onMouseEnter={this.highlightMarker}\n                onMouseLeave={this.unHighlightMarker}\n            >\n                <div className=\"thumbImg\">\n                    <a href={project.url}>\n                        <img src={project.image} alt={project.title} />\n                    </a>\n                </div>\n                <div>\n                    <h1>\n                        <a href={project.url}>{project.title}</a>\n                    </h1>\n                    <p className=\"projectOrg\">\n                        <a href={project.organisation_url}>{project.organisation}</a>\n                    </p>\n                    <p className=\"projectLocation\">\n                        <i className=\"fa fa-map-marker\" />\n                        {countries}\n                    </p>\n                </div>\n            </li>\n        );\n    }\n});\n\nvar Update = React.createClass({\n    highlightMarker: function() {\n        return changeNodeMarkerIcon(this.getDOMNode(), google.maps.Animation.BOUNCE);\n    },\n    unHighlightMarker: function() {\n        return changeNodeMarkerIcon(this.getDOMNode(), null);\n    },\n    render: function() {\n        var project = this.props.project,\n            element_id = \"project-\" + project.id;\n        return (\n            <li\n                id={element_id}\n                onMouseEnter={this.highlightMarker}\n                onMouseLeave={this.unHighlightMarker}\n                className=\"updateAsset\"\n            >\n                <div className=\"thumbImg\">\n                    <a href={project.url}>\n                        <img src={project.image} alt={project.title} />\n                    </a>\n                </div>\n                <div>\n                    <h1>\n                        <a href={project.url}>{project.title}</a>\n                    </h1>\n                    <div>\n                        <span>Project: </span>\n                        <a href={project.project_url} class=\"projectTitle\">\n                            {project.project}\n                        </a>\n                    </div>\n                    <div>\n                        <span>Created by: </span>\n                        <span class=\"userFullName\">{project.user_fullname}</span>\n                    </div>\n                    <div>\n                        <span>Org: </span>\n                        <a href={project.organisation_url} class=\"orgName\">\n                            {project.organisation}\n                        </a>\n                    </div>\n                    <div class=\"upDateTime\">{project.event_date}</div>\n                </div>\n            </li>\n        );\n    }\n});\n\nvar Organisation = React.createClass({\n    render: function() {\n        var organisation = this.props.organisation,\n            element_id = \"organisation-\" + organisation.id;\n        return (\n            <li id={element_id}>\n                <div>\n                    <a href={organisation.url}>\n                        <img src={organisation.image} alt={organisation.title} />\n                    </a>\n                </div>\n                <div>\n                    <h1>\n                        <a href={organisation.url}>{organisation.name}</a>\n                    </h1>\n                    <div className=\"orgType\">{organisation.organisation_type}</div>\n                </div>\n                <div className=\"hidden-xs hidden-sm additionalInfo\">\n                    <div>\n                        <span>{organisation.project_count} projects</span>\n                    </div>\n                </div>\n            </li>\n        );\n    }\n});\n\nvar ProjectDirectory = React.createClass({\n    componentDidUpdate: function(prevProps) {\n        // If projects changed\n        if (this.props.projects != prevProps.projects) {\n            // Update map\n            if (!this.props.hide_map) {\n                window.render_map(\n                    document.querySelector(\"#akvo_map_projects\"),\n                    this.getMapConfig()\n                );\n            }\n            // Scroll the project list container to the top\n            ReactDOM.findDOMNode(this).querySelector(\"#projList\").scrollTop = 0;\n        }\n    },\n    getLocations: function() {\n        var projects = this.props.projects;\n        return projects.map(function(project) {\n            return {\n                latitude: project.latitude,\n                longitude: project.longitude,\n                url: project.url,\n                text: project.title,\n                icon: \"/static/images/maps/blueMarker.png\",\n                image: project.image,\n                highlightId: \"#project-\" + project.id\n            };\n        }, this);\n    },\n    getMapConfig: function() {\n        return {\n            dynamic: true,\n            locations: this.getLocations(),\n            clickCallback: this.props.setCountry\n        };\n    },\n    // FIXME: Need to have a better display when things are loading....\n    render: function() {\n        var project_count_text =\n                this.props.project_count != undefined\n                    ? this.props.project_count + \" \" + this.props.elements_text\n                    : this.props.i18n.loading_text,\n            filtered = this.props.filtered ? \" filtered\" : \"\",\n            listWidth = this.props.hide_map ? \"col-sm-12\" : \"col-sm-7\",\n            listMsg = this.props.i18n.list_message_text;\n\n        return (\n            <section className=\"main-list projects\">\n                <div className=\"container-fluid\">\n                    <div className=\"row\">\n                        {this.props.disabled ? (\n                            <div\n                                style={{\n                                    position: \"absolute\",\n                                    width: \"100%\",\n                                    height: \"calc(100vh - 160px)\",\n                                    background: \"white\",\n                                    margin: \"auto\",\n                                    padding: \"20px\",\n                                    zIndex: \"100000\",\n                                    textAlign: \"center\"\n                                }}\n                            >\n                                <div style={{ marginTop: \"calc(25vh)\" }}>\n                                    <i className=\"fa fa-spin fa-spinner\" />\n                                </div>\n                            </div>\n                        ) : (\n                            undefined\n                        )}\n\n                        <div\n                            className={listWidth + \" projectListUlcontain \" + filtered}\n                            id=\"projList\"\n                        >\n                            <p className=\"text-center listMsg\">{listMsg}</p>\n                            <ul className=\"projectListUl group\">\n                                {this.props.projects.map(function(project) {\n                                    if (this.props.type == \"projects\") {\n                                        return (\n                                            <Project\n                                                project={project}\n                                                i18n={this.props.i18n}\n                                                key={\"project\" + project.id}\n                                            />\n                                        );\n                                    } else if (this.props.type == \"updates\") {\n                                        return (\n                                            <Update\n                                                project={project}\n                                                i18n={this.props.i18n}\n                                                key={\"project\" + project.id}\n                                            />\n                                        );\n                                    } else if (this.props.type == \"organisations\") {\n                                        return (\n                                            <Organisation\n                                                organisation={project}\n                                                i18n={this.props.i18n}\n                                                key={\"organisation\" + project.id}\n                                            />\n                                        );\n                                    }\n                                }, this)}\n                            </ul>\n                            <div className=\"container-fluid pageStatus text-center\">\n                                <div className=\"row\">\n                                    <div className=\"col-xs-6 col-xs-offset-3\">\n                                        <span className=\"label label-info projectTotal\">\n                                            {project_count_text}\n                                        </span>\n                                        <Pagination\n                                            onChange={this.props.onChange}\n                                            page={this.props.page}\n                                            limit={this.props.limit}\n                                            project_count={this.props.project_count}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        {this.props.hide_map ? (\n                            undefined\n                        ) : (\n                            <div className=\"col-sm-5\">\n                                <section id=\"map\" className=\"touch-navbar\">\n                                    <div id=\"akvo_map_projects\" className=\"rsr_map\" />\n                                </section>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </section>\n        );\n    }\n});\n\nvar Pagination = React.createClass({\n    getPages: function() {\n        return Math.ceil(this.props.project_count / this.props.limit);\n    },\n    onSelect: function(e) {\n        e.preventDefault();\n        this.props.onChange(\"page\", e.target.text);\n    },\n    render: function() {\n        var Pagination = ReactBootstrap.Pagination;\n        return (\n            <div className=\"center-text pgWrap \">\n                <Pagination\n                    boundaryLinks={true}\n                    activePage={parseInt(this.props.page)}\n                    items={this.getPages()}\n                    maxButtons={3}\n                    onSelect={this.onSelect}\n                />\n            </div>\n        );\n    }\n});\n\nvar TextSearch = React.createClass({\n    getInitialState: function() {\n        return {\n            value: \"\",\n            options: []\n        };\n    },\n    componentDidMount: function() {\n        var options = this.fetchOptions();\n    },\n    componentWillReceiveProps: function(nextProps) {\n        this.setState({ value: nextProps.text || \"\" });\n    },\n    fetchOptions: function() {\n        var url = this.props.typeaheadUrl,\n            app = this;\n\n        fetch(url, {})\n            .then(function(response) {\n                if (response.status >= 200 && response.status < 300) {\n                    return response.json();\n                }\n            })\n            .then(function(options) {\n                app.setState({ options: app.mungeOptions(options.results) || [] });\n            });\n        return [];\n    },\n    getUrl: function(entry) {\n        if (this.props.type == \"projects\") {\n            return \"../project/\" + entry.id;\n        } else if (this.props.type == \"updates\") {\n            return \"../project/\" + entry.project + \"/update/\" + entry.id;\n        } else if (this.props.type == \"organisations\") {\n            return \"../organisation/\" + entry.id;\n        }\n    },\n    mungeOptions: function(options) {\n        return options.map(function(option) {\n            option.id = String(option.id);\n            return option;\n        });\n    },\n    onChange: function(projects) {\n        var project = projects[0],\n            url = this.getUrl(project);\n\n        window.location.href = url;\n    },\n    onInputChange: function(value) {\n        this.setState({ value: value });\n    },\n    onSubmit: function(e) {\n        this.props.onChange(\"title_or_subtitle\", this.state.value);\n    },\n    render: function() {\n        var Typeahead = ReactBootstrapTypeahead.Typeahead,\n            filterBy;\n\n        if (this.props.type == \"projects\") {\n            filterBy = [\"id\", \"title\", \"subtitle\"];\n        } else if (this.props.type == \"updates\") {\n            filterBy = [\"title\"];\n        } else if (this.props.type == \"organisations\") {\n            filterBy = [\"name\", \"long_name\"];\n        }\n\n        return (\n            <div className=\"form-inline col-lg-4 col-md-4\" role=\"form\">\n                <div className=\"form-group\">\n                    <div className=\"input-group\">\n                        <Typeahead\n                            name={this.props.name}\n                            options={this.state.options}\n                            onChange={this.onChange}\n                            onInputChange={this.onInputChange}\n                            filterBy={filterBy}\n                            labelKey={function(x) {\n                                return x.title || x.name;\n                            }}\n                            highlightOnlyResult={true}\n                            placeholder={this.props.text_placeholder}\n                            disabled={this.props.disabled}\n                            maxResults={10}\n                            minLength={3}\n                        />\n\n                        <span className=\"input-group-btn\">\n                            <button className=\"btn btn-primary\" onClick={this.onSubmit}>\n                                {this.props.i18n.search_text}\n                            </button>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n});\n\nvar SearchBar = React.createClass({\n    render: function() {\n        var get_selection = function(filter_name) {\n            var options = this.props.options,\n                id = this.props.selected[filter_name],\n                dropdown_field = this.props.filters.indexOf(filter_name) > -1,\n                find_function = function(option) {\n                    return option.id == id;\n                },\n                selection = dropdown_field ? options[filter_name].find(find_function) : id,\n                selection_clone = dropdown_field ? Object.assign({}, selection) : id;\n            return dropdown_field ? (_.isEmpty(selection_clone) ? [] : [selection_clone]) : id;\n        };\n        var create_filter = function(filter_name) {\n            var selection = get_selection.call(this, filter_name);\n            return (\n                <Filter\n                    ref={filter_name}\n                    key={filter_name}\n                    options={this.props.options[filter_name]}\n                    name={filter_name}\n                    display_name={this.props.i18n[filter_name + \"_text\"]}\n                    selected={selection}\n                    onChange={this.props.onChange}\n                    disabled={this.props.disabled}\n                />\n            );\n        };\n        var reset_button = _.isEmpty(\n            _.pick(this.props.selected, \"location\", \"organisation\", \"sector\", \"title_or_subtitle\")\n        ) ? (\n            undefined\n        ) : (\n            <span className=\"pull-right\">\n                <a className=\"btn\" onClick={this.props.resetFilters}>\n                    X {this.props.i18n.reset_filters_text}\n                </a>\n            </span>\n        );\n        return (\n            <section id=\"search-filter\" className=\"container-fluid\">\n                <div id=\"search\" className=\"row searchBar\">\n                    <TextSearch\n                        type={this.props.type}\n                        typeaheadUrl={this.props.typeaheadUrl}\n                        text={this.props.selected.title_or_subtitle}\n                        i18n={this.props.i18n}\n                        text_placeholder={this.props.text_placeholder}\n                        projects={this.props.projects}\n                        onChange={this.props.onChange}\n                    />\n                    <div id=\"filter-wrapper col-sm-12 col-lg-6 col-md-6 col-lg-offset-2 col-md-offset-2\">\n                        <div>\n                            {this.props.filters.map(create_filter, this)}\n                            {reset_button}\n                        </div>\n                    </div>\n                </div>\n            </section>\n        );\n    }\n});\n\nvar App = React.createClass({\n    /* React class methods */\n    getInitialState: function() {\n        var options = {\n            keyword: [],\n            location: [],\n            organisation: [],\n            sector: []\n        };\n        var urlState = this.getStateFromUrl();\n        var state = {\n            options: options,\n            selected: urlState,\n            filtered: Object.keys(urlState).length > 0,\n            disabled: true,\n            projects: []\n        };\n        return state;\n    },\n    componentDidMount: function() {\n        var app = this;\n        this.fetchData(true);\n        window.onpopstate = function(popstate) {\n            if (!_.isEqual(app.state.selected, popstate.state)) {\n                app.setState({ selected: popstate.state || {} }, app.fetchData);\n            }\n        };\n    },\n    render: function() {\n        var elements_text = this.props.i18n[this.props.type + \"_text\"];\n        return (\n            <div>\n                <SearchBar\n                    typeaheadUrl={this.props.typeahead_url}\n                    resetFilters={this.resetFilters}\n                    onChange={this.onFilterChange}\n                    filters={this.props.dropdown_filters}\n                    disabled={this.state.disabled}\n                    projects={this.state.projects}\n                    project_count={this.state.project_count}\n                    i18n={this.props.i18n}\n                    options={this.state.options}\n                    selected={this.state.selected}\n                    text_placeholder={elements_text}\n                    type={this.props.type}\n                />\n                <ProjectDirectory\n                    hide_map={this.props.hide_map}\n                    type={this.props.type}\n                    onChange={this.onFilterChange}\n                    limitOptions={this.state.options.limit}\n                    page={this.state.selected.page || 1}\n                    limit={this.state.selected.limit || this.state.page_size_default || 16}\n                    projects={this.state.projects}\n                    project_count={this.state.project_count}\n                    i18n={this.props.i18n}\n                    elements_text={elements_text}\n                    disabled={this.state.disabled}\n                    filtered={this.state.filtered}\n                    setCountry={this.setCountry}\n                />\n            </div>\n        );\n    },\n\n    /* Event handlers */\n    onFilterChange: function(field_name, values) {\n        var update = {};\n        Object.assign(update, this.state.selected);\n        if (values.length > 0) {\n            update[field_name] = typeof values == \"string\" ? values : values[0].id;\n            if (field_name !== \"page\" && update[field_name] !== this.state.selected[field_name]) {\n                update[\"page\"] = 1;\n            }\n        } else {\n            delete update[field_name];\n        }\n        this.setState(\n            { selected: update, filtered: Object.keys(update).length > 0 },\n            this.fetchData\n        );\n        this.updateHistory(update);\n    },\n    resetFilters: function() {\n        this.setState({ selected: {}, filtered: false }, this.fetchData);\n    },\n\n    /* Helper methods */\n    cacheAllOptions: function() {\n        // Cache the options to show when there are no selections\n        var self = this;\n        var url = this.getOptionsUrl({});\n        if (!options_cache[url]) {\n            fetch(url, {})\n                .then(self.parseResponse)\n                .then(function(options) {\n                    if (options) {\n                        self.cacheOptions(url, self.processOptions(options));\n                    }\n                });\n        }\n    },\n    cacheOptions: function(url, options) {\n        // Adds the specified options to the cache, for the given url\n        options_cache[url] = options;\n    },\n    fetchData: function(mountedNow) {\n        var url = this.getOptionsUrl(this.state.selected),\n            cached_options = options_cache[url];\n        if (cached_options && cached_options.project_count) {\n            this.updateState(Object.assign({}, cached_options));\n        } else {\n            this.setState({ disabled: true });\n            var self = this;\n            fetch(url, {})\n                .then(self.parseResponse)\n                .then(function(options) {\n                    if (options) {\n                        var processedOptions = self.processOptions(options);\n                        self.updateState(processedOptions, mountedNow);\n                        self.cacheOptions(url, processedOptions);\n                        if (mountedNow) {\n                            self.cacheAllOptions();\n                        }\n                    }\n                });\n        }\n    },\n    getOptionsUrl: function(selected) {\n        var params = { format: \"json\" };\n        params = Object.keys(Object.assign(params, selected))\n            .map(function(key) {\n                return key + \"=\" + encodeURIComponent(params[key]);\n            })\n            .join(\"&\");\n        return this.props.options_url + \"?\" + params;\n    },\n    getProjectUrl: function(project) {\n        return \"../project/\" + project.id;\n    },\n    getStateFromUrl: function() {\n        var selected = {};\n        var query = location.search.substring(1);\n        // Treat iati_status query param as status param\n        query = query.replace(\"iati_status\", \"status\");\n        // Allow using partner as a query param for organisation\n        query = query.replace(\"partner\", \"organisation\");\n        if (query === \"\") {\n            return selected;\n        }\n        query.split(\"&\").map(function(query_term) {\n            var pair = query_term.split(\"=\"),\n                key = decodeURIComponent(pair[0]),\n                value = decodeURIComponent(pair[1]);\n            if (value !== \"\" && this.isFilter(key)) {\n                selected[key] = value;\n            }\n        }, this);\n        return selected;\n    },\n    isFilter: function(name, dropdown) {\n        return dropdown\n            ? this.props.dropdown_filters.indexOf(name) > -1\n            : this.props.dropdown_filters.indexOf(name) > -1 ||\n                  this.props.hidden_or_other.indexOf(name) > -1;\n    },\n    parseResponse: function(response) {\n        if (response.status >= 200 && response.status < 300) {\n            return response.json();\n        }\n    },\n    processOptions: function(options) {\n        // Add a filterBy attribute to all items\n        var make_typeahead_item = function(item) {\n            // Check various fields depending on type of options\n            // NOTE: name always appears after long_name, since we\n            // prefer long_name for organisations\n            var label = item.label || item.long_name || item.name || \"\",\n                spaces = label.match(/\\s+/i);\n            // Stringify the id;\n            item.id = String(item.id);\n            item.filterBy = label.trim() + \" \" + item.id;\n            item.indent = parseInt((spaces ? spaces[0].length : 0) / 4) * 4;\n            item.label = label.trim();\n        };\n        for (var key in options) {\n            if (this.isFilter(key, true)) {\n                var value = options[key];\n                value.forEach(make_typeahead_item);\n            }\n        }\n        return options;\n    },\n    setCountry: function(name) {\n        console.log(name);\n        var locations = this.state.options.location;\n        for (var i in locations) {\n            if (locations[i].label == name) {\n                this.onFilterChange(\"location\", [locations[i]]);\n                break;\n            }\n        }\n    },\n    updateHistory: function(state) {\n        if (_.isEqual(state, history.state)) {\n            // Don't update if current state is same as new state\n            return;\n        }\n        // Update the browser URL\n        var queries = _.pairs(state).map(function(q) {\n                var key = q[0],\n                    val = q[1];\n                return key + \"=\" + encodeURI(val);\n            }),\n            title = _.pairs(state).map(function(q) {\n                var key = q[0],\n                    val = q[1];\n                return key + \": \" + encodeURI(val);\n            }),\n            url = queries.length > 0 ? \"?\" + queries.join(\"&\") : \"./\";\n\n        window.history.pushState(state, document.title + \" \" + title.join(\", \"), url);\n    },\n    updateState: function(options, mountedNow) {\n        this.setState({\n            options: options,\n            disabled: false,\n            project_count: options.project_count,\n            page_size_default: options.page_size_default,\n            projects: options.projects\n        });\n    }\n});\n\n// Add global variables for other scripts to use\nwindow.DirectoryApp = App;\n"],"sourceRoot":""}