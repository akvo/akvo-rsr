{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./scripts-src/my-reports.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","endpoints","i18n","Typeahead","cookieValue","document","cookie","cookies","split","length","trim","substring","decodeURIComponent","getCookie","get_display_value","id","options","values","filter","option","displayOption","initReact","ReactTypeahead","OrganisationTypeahead","React","createClass","displayName","getInitialState","placeholder","select_an_organisation","componentDidMount","this","props","organisationOptions","selectOrg","setState","org","setOrganisation","render","createElement","className","state","maxVisible","orgId","onOptionSelected","filterOption","customClasses","input","SelectOrganisation","organisation","Reports","reports","report_count","row_count","Math","round","ceil","row_indexes","Array","from","keys","col_indexes","self","map","row","col","report","undefined","Report","disabled","ReportFormatButton","onClick","e","stopPropagation","download","format_name","icon","display_name","icon_class","text","downloadReport","format","url","download_url","replace","window","location","assign","formats","title","description","MyReportsApp","reportOptions","getOptions","user_organisations","processOrgs","processReports","endpoint","stateKey","processCallback","xmlHttp","XMLHttpRequest","base_url","thisApp","onreadystatechange","readyState","DONE","status","newState","JSON","parse","responseText","results","open","send","orgResults","forEach","short","long","newName","long_name","reportResults","parameters","indexOf","setReport","my_reports","ReactDOM","getElementById","loadJS","implementationCode","scriptTag","src","onload","appendChild","addEventListener","innerHTML","loadReactTypeahead","reactTypeaheadSrc","body","console","log","reactSrc","reactDOMSrc","loadAndRenderReact"],"mappings":"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","file":"myReports.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1062);\n","// Akvo RSR is covered by the GNU Affero General Public License.\n// See more details in the license.txt file located at the root folder of the\n// Akvo RSR module. For additional details on the GNU license please see\n// < http://www.gnu.org/licenses/agpl.html >.\n\nvar endpoints, i18n, Typeahead;\n\n// CSRF TOKEN\nfunction getCookie(name) {\n    var cookieValue = null;\n    if (document.cookie && document.cookie !== \"\") {\n        var cookies = document.cookie.split(\";\");\n        for (var i = 0; i < cookies.length; i++) {\n            var cookie = cookies[i].trim();\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) == name + \"=\") {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\nvar csrftoken = getCookie(\"csrftoken\");\n\nvar parameter_needed = function(report, parameter) {\n    if (report == null) {\n        return false;\n    }\n    for (var i = 0; i < report.parameters.length; i++) {\n        if (report.parameters[i] === parameter) {\n            return true;\n        }\n    }\n    return false;\n};\n\nvar get_display_value = function(id, options) {\n    if (id == null) {\n        return null;\n    }\n    var values = options.filter(function(option) {\n        return option.id == id;\n    });\n    return values.length > 0 ? values[0].displayOption : null;\n};\n\nfunction initReact() {\n    // Load globals\n    Typeahead = ReactTypeahead.Typeahead;\n\n    var OrganisationTypeahead = React.createClass({\n        getInitialState: function() {\n            return {\n                placeholder: i18n.select_an_organisation\n            };\n        },\n\n        componentDidMount: function() {\n            if (this.props.organisationOptions.length === 1) {\n                this.selectOrg(this.props.organisationOptions[0]);\n                this.setState({\n                    placeholder: this.props.organisationOptions[0].displayOption\n                });\n            }\n        },\n\n        selectOrg: function(org) {\n            this.props.setOrganisation(org.id);\n        },\n\n        render: function() {\n            return (\n                <div className=\"form-group\">\n                    {React.createElement(Typeahead, {\n                        placeholder: this.state.placeholder,\n                        maxVisible: 10,\n                        value: get_display_value(this.props.orgId, this.props.organisationOptions),\n                        options: this.props.organisationOptions,\n                        onOptionSelected: this.selectOrg,\n                        displayOption: \"displayOption\",\n                        filterOption: \"filterOption\",\n                        customClasses: { input: \"form-control\" }\n                    })}\n                </div>\n            );\n        }\n    });\n\n    var SelectOrganisation = function(props) {\n        var organisation;\n        if (props.organisationOptions.length == 0) {\n            organisation = <div />;\n        } else if (props.organisationOptions.length == 1) {\n            organisation = <p>{props.organisationOptions[0].displayOption}</p>;\n        } else {\n            organisation = (\n                <div className=\"org-typeahead\">\n                    <OrganisationTypeahead\n                        orgId={props.organisation}\n                        organisationOptions={props.organisationOptions}\n                        setOrganisation={props.setOrganisation}\n                    />\n                </div>\n            );\n        }\n        return (\n            <div id=\"choose-organisation\">\n                <label>{i18n.organisation}</label>\n                {organisation}\n            </div>\n        );\n    };\n\n    var Reports = React.createClass({\n        render: function() {\n            var reports = this.props.reports,\n                report_count = (reports && reports.length) || 0,\n                row_count = Math.round(Math.ceil(report_count / 3)),\n                row_indexes = Array.from(Array(row_count).keys()),\n                col_indexes = Array.from(Array(3).keys()),\n                self = this;\n            return (\n                <div className=\"rsrReports\">\n                    {row_indexes.map(function(row) {\n                        return (\n                            <div className=\"row\" key={row}>\n                                {col_indexes.map(function(col) {\n                                    var index = row * 3 + col,\n                                        report = reports[index];\n                                    if (report === undefined) {\n                                        return;\n                                    }\n                                    return (\n                                        <Report\n                                            disabled={self.props.disabled}\n                                            orgId={self.props.organisation}\n                                            report={report}\n                                            key={report.id}\n                                        />\n                                    );\n                                })}\n                            </div>\n                        );\n                    })}\n                </div>\n            );\n        }\n    });\n\n    var ReportFormatButton = React.createClass({\n        onClick: function(e) {\n            e.stopPropagation();\n            this.props.download(this.props.format_name);\n        },\n\n        render: function() {\n            const icon = this.props.icon,\n                display_name = this.props.display_name,\n                icon_class = \"fa fa-\" + icon,\n                text = i18n.download + \" \" + display_name;\n            return (\n                <button\n                    className=\"btn btn-default reportDown\"\n                    onClick={this.onClick}\n                    disabled={this.props.disabled}\n                >\n                    <i className={icon_class} />\n                    <span>&nbsp;&nbsp;</span>\n                    <span>{text}</span>\n                </button>\n            );\n        }\n    });\n\n    var Report = React.createClass({\n        downloadReport: function(format) {\n            var url = this.props.report.url,\n                orgId = this.props.orgId,\n                download_url = url.replace(\"{format}\", format).replace(\"{organisation}\", orgId);\n            window.location.assign(download_url);\n        },\n\n        render: function() {\n            var report = this.props.report,\n                self = this,\n                formats = report.formats.map(function(format) {\n                    var icon = format.icon,\n                        name = format.name,\n                        display_name = format.display_name;\n                    return (\n                        <ReportFormatButton\n                            disabled={self.props.disabled}\n                            download={self.downloadReport}\n                            icon={icon}\n                            format_name={name}\n                            display_name={display_name}\n                            url={report.url}\n                            key={format.name}\n                        />\n                    );\n                });\n            return (\n                <div className=\"rsrReport col-sm-6 col-md-4\">\n                    <div className=\"reportContainer\">\n                        <div className=\"\">\n                            <h3 className=\"\">{report.title}</h3>\n                        </div>\n                        <div className=\"reportDscr\">{report.description}</div>\n                        <div className=\"options\">{formats}</div>\n                    </div>\n                </div>\n            );\n        }\n    });\n\n    var MyReportsApp = React.createClass({\n        getInitialState: function() {\n            return {\n                reportOptions: [],\n                organisation: null,\n                organisationOptions: []\n            };\n        },\n\n        componentDidMount: function() {\n            this.getOptions(endpoints.user_organisations, \"organisationOptions\", this.processOrgs);\n            this.getOptions(endpoints.reports, \"reportOptions\", this.processReports);\n        },\n\n        getOptions: function(endpoint, stateKey, processCallback) {\n            var xmlHttp = new XMLHttpRequest();\n            var url = endpoints.base_url + endpoint + \"?format=json\";\n            var thisApp = this;\n            xmlHttp.onreadystatechange = function() {\n                if (xmlHttp.readyState == XMLHttpRequest.DONE && xmlHttp.status == 200) {\n                    var newState = {};\n                    if (processCallback === undefined) {\n                        newState[stateKey] = JSON.parse(xmlHttp.responseText).results;\n                    } else {\n                        newState[stateKey] = processCallback(\n                            JSON.parse(xmlHttp.responseText).results\n                        );\n                    }\n                    thisApp.setState(newState);\n                }\n            };\n            xmlHttp.open(\"GET\", url, true);\n            xmlHttp.send();\n        },\n\n        processOrgs: function(orgResults) {\n            function getDisplayOption(short, long) {\n                if (short === long) {\n                    return short;\n                }\n                if (!long) {\n                    return short;\n                }\n                return short + \" (\" + long + \")\";\n            }\n\n            orgResults.forEach(function(o) {\n                var newName = getDisplayOption(o.name, o.long_name);\n\n                o.filterOption = o.name + \" \" + o.long_name;\n                o.displayOption = newName;\n            });\n\n            // If only one organisation, also set the app state\n            if (orgResults.length == 1) {\n                this.setOrganisation(orgResults[0].id);\n            }\n\n            return orgResults;\n        },\n\n        processReports: function(reportResults) {\n            // remove reports which have project as a parameter\n            return reportResults.filter(function(report) {\n                return report.parameters.indexOf(\"project\") == -1;\n            });\n        },\n\n        setReport: function(report) {\n            this.setState({\n                report: report\n            });\n        },\n\n        setOrganisation: function(org) {\n            this.setState({\n                organisation: org\n            });\n        },\n\n        render: function() {\n            return (\n                <div id=\"my-reports\">\n                    <h3>{i18n.my_reports}</h3>\n                    <SelectOrganisation\n                        organisationOptions={this.state.organisationOptions}\n                        report={this.state.report}\n                        organisation={this.state.organisation}\n                        setOrganisation={this.setOrganisation}\n                    />\n                    <Reports\n                        reports={this.state.reportOptions}\n                        organisation={this.state.organisation}\n                        disabled={!this.state.organisation}\n                    />\n                </div>\n            );\n        }\n    });\n\n    // Initialize the 'My reports' app\n    ReactDOM.render(React.createElement(MyReportsApp), document.getElementById(\"container-fluid\"));\n}\n\nvar loadJS = function(url, implementationCode, location) {\n    //url is URL of external file, implementationCode is the code\n    //to be called from the file, location is the location to\n    //insert the <script> element\n\n    var scriptTag = document.createElement(\"script\");\n    scriptTag.src = url;\n\n    scriptTag.onload = implementationCode;\n    scriptTag.onreadystatechange = implementationCode;\n\n    location.appendChild(scriptTag);\n};\n\nfunction loadAndRenderReact() {\n    function loadReactTypeahead() {\n        var reactTypeaheadSrc = document.getElementById(\"react-typeahead\").src;\n        loadJS(reactTypeaheadSrc, initReact, document.body);\n    }\n\n    function loadReactDOM() {\n        var reactDOMSrc = document.getElementById(\"react-dom\").src;\n        loadJS(reactDOMSrc, loadReactTypeahead, document.body);\n    }\n\n    console.log(\"No React, load again.\");\n    var reactSrc = document.getElementById(\"react\").src;\n    loadJS(reactSrc, loadReactDOM, document.body);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n    // Retrieve data endpoints and translations\n    endpoints = JSON.parse(document.getElementById(\"data-endpoints\").innerHTML);\n    i18n = JSON.parse(document.getElementById(\"translation-texts\").innerHTML);\n\n    // Check if React is loaded\n    if (\n        typeof React !== \"undefined\" &&\n        typeof ReactDOM !== \"undefined\" &&\n        typeof ReactTypeahead !== \"undefined\"\n    ) {\n        initReact();\n    } else {\n        loadAndRenderReact();\n    }\n});\n"],"sourceRoot":""}